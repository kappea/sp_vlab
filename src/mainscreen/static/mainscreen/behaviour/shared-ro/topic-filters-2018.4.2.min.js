$.fn.topicSearch=function(){return this.each(function(){function e(){n(),a(),l()}function n(){c.on("submit",function(t){t.preventDefault(),r(h.val())}),c.find(".clearField").on("click",function(){p()}),h.on("keyup",function(){""===$(this).val()&&p()}),u.find("h3 a").on("click",function(t){if("mobile"===Core.viewport||"phablet"===Core.viewport){t.preventDefault();var e=$(this),n=$(this).parent("h3").next("ul");e.hasClass("panelOpen")?(e.removeClass("panelOpen"),n.removeClass("panelOpen")):(e.addClass("panelOpen"),n.addClass("panelOpen"))}})}function a(){d.each(function(t,e){var n=$(this).html().toLowerCase().trim().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"");if($(this).attr("data-topicid",t),f.indexOf(n)<0&&""!==n&&f.push(n),$(this).data("alternative-spellings")){var a=$(this).data("alternative-spellings").toString(),o=a.split(", ");$.each(o,function(t,e){searchOption=e.toLowerCase().trim().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,""),f.indexOf(searchOption)<0&&""!==searchOption&&f.push(searchOption)})}}),f.sort(),o()}function o(){h.autocomplete({minLength:1,delay:200,appendTo:"#topicSearch",source:function(t,e){var n=new RegExp("^"+$.ui.autocomplete.escapeRegex(t.term),"i");e($.grep(f,function(t){return n.test(t)}))},select:function(t,e){r(e.item.value)},open:function(t,e){$(".ui-autocomplete").scrollTop(0),$(".ui-autocomplete").find("li").attr("role","option")},create:function(t,e){$(".ui-autocomplete").attr("role","listbox")}}),h.attr("aria-autocomplete","inline"),h.attr("role","combobox")}function r(t){$(".ui-autocomplete").scrollTop(0),h.autocomplete("close");var e=[],n=t.toLowerCase().replace(/[^a-z\d\s]+/gi,"").trim();n.length>1?($(".populairTopicsWrapper").hide(),$(".topicList li a").each(function(t,a){var o=$(this).html().toLowerCase().replace(/[^a-z\d\s]+/gi,"").trim(),i=$(this).attr("data-topicid");if(n===o)e.push({topicid:i,rank:1});else if(o.indexOf(n)>=0)e.push({topicid:i,rank:2});else if($(this).data("alternative-spellings")){var r=$(this).data("alternative-spellings").toString(),p=r.split(", ");$.each(p,function(t,a){var o=a.toLowerCase().replace(/[^a-z\d\s]+/gi,"").trim();""!==o&&(n===o?e.push({topicid:i,rank:3,keyword:o}):o.indexOf(n)>=0&&e.push({topicid:i,rank:4,keyword:o}))})}}),e.sort(function(t,e){return t.rank-e.rank}),s(e,n)):($(".topicResults").remove(),u.show())}function p(){$(".topicResults").remove(),$(".populairTopicsWrapper").show(),h.val("").trigger("change"),u.show()}function s(e,n){$(".topicResults").remove(),$(".showList").show(),u.hide();var a=$("<div/>",{"class":"topicResults",html:"<h2>"+v.results+"</h2>"}).appendTo(".topicSearchWrapper"),o=[],r=Object.keys(e).length;r>0?($.each(e,function(e,n){var r=u.find("a[data-topicid='"+n.topicid+"']"),p=[];if(r.attr("data-alternative-spellings")){var s=r.attr("data-alternative-spellings").toString().split(", ");for(i=p.length;i<5;){if("undefined"!=typeof s[i]){var l=s[i].trim().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"");""!==l&&p.indexOf(l)===-1&&p.push(l)}i++}}var c="";if(p.length>0){var h="";for(t=0;t<3;t++)"undefined"!=typeof p[t]&&(h+=p[t]),t<2&&"undefined"!=typeof p[t+1]&&(h+=", ");c="<p>"+v.foundOn+": "+h+"</p>"}if(o.indexOf(r.html())===-1){o.push(r.html());var d=$("<div/>",{"class":"foundTopic"}).appendTo(a),f=$("<a/>",{href:r.attr("href"),"data-keyword":r.html(),html:"<h3>"+r.html()+"</h3>"+c}).appendTo(d);f.on("click",function(){_paq.push(["trackEvent","Onderwerp overzicht","Gevonden onderwerp openen",$(this).data("keyword")])})}}),_paq.push(["trackEvent","Onderwerp overzicht","Onderwerp zoeken",n,o.length])):(_paq.push(["trackEvent","Onderwerp overzicht","Onderwerp zoeken",n,"0"]),$("<p/>",{html:v.noresults}).appendTo(a),$("<button/>",{id:"showAllTopics",text:v.noResultsBtn}).appendTo(a).on("click",function(t){t.preventDefault(),p()}))}function l(){$("a[href='#topic-home']").click(function(t){t.preventDefault(),t.stopPropagation();var e=$(this.hash),n="a[name="+this.hash.slice(1)+"]";e=e.length&&e||$(n);var a=e.offset().top;$("html, body").stop().animate({scrollTop:a},500)})}var c=$(this),h=$("#topicQ"),u=$(".topicList"),d=u.find("li a"),f=($(".topicsList"),[]),v={results:c.attr("data-results")||"Gevonden onderwerpen",noresults:c.attr("data-noresults")||"Geen onderwerpen gevonden",noResultsBtn:c.attr("data-show-all-btn-txt")||"Toon alle onderwerpen",foundOn:c.attr("data-found-on-keyword")||"Gaat over"};e()})},$("#topicSearch").topicSearch();