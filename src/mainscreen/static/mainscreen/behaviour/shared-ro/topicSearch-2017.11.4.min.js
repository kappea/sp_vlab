$.fn.topicSearch=function(){return this.each(function(){function e(){o(),n(),p()}function o(){c.on("submit",function(e){e.preventDefault(),r(l.val())}),h.find(".theme h3").on("click",function(e){var t=$(this).parent(".theme");t.find("ul").is(":visible")&&!t.hasClass("open")||(e.preventDefault(),t.hasClass("open")?t.removeClass("open"):t.addClass("open"))})}function n(){u.each(function(e,t){var o=$(this).html().toLowerCase().trim().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"");$(this).attr("data-topicid",e),d.indexOf(o)<0&&""!==o&&d.push(o);var n=$(this).data("alternative-spellings"),i=n.split(", ");$.each(i,function(e,t){searchOption=t.toLowerCase().trim().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,""),d.indexOf(searchOption)<0&&""!==searchOption&&d.push(searchOption)})}),d.sort(),a()}function a(){l.autocomplete({minLength:1,delay:200,appendTo:"#topicSearch",source:function(e,t){var o=new RegExp("^"+$.ui.autocomplete.escapeRegex(e.term),"i");t($.grep(d,function(e){return o.test(e)}))},select:function(e,t){r(t.item.value)},open:function(e,t){$(".ui-autocomplete").scrollTop(0),$(".ui-autocomplete").off("menufocus hover mouseover mouseenter"),$(".ui-autocomplete").find("li").attr("role","option")},create:function(e,t){$(".ui-autocomplete").attr("role","listbox")}}),l.attr("aria-autocomplete","inline"),l.attr("role","combobox")}function r(e){$(".ui-autocomplete").scrollTop(0),l.autocomplete("close");var t=[],o=e.toLowerCase().replace(/[^a-z\d\s]+/gi,"").trim();o.length>1?($(".topicsOverview li a").each(function(e,n){var i=$(this).html().toLowerCase().replace(/[^a-z\d\s]+/gi,"").trim(),a=$(this).attr("data-topicid");if(o===i)t.push({topicid:a,rank:1});else if(i.indexOf(o)>=0)t.push({topicid:a,rank:2});else{var r=$(this).data("alternative-spellings"),s=r.split(", ");$.each(s,function(e,n){var i=n.toLowerCase().replace(/[^a-z\d\s]+/gi,"").trim();""!==i&&(o===i?t.push({topicid:a,rank:3,keyword:i}):i.indexOf(o)>=0&&t.push({topicid:a,rank:4,keyword:i}))})}}),t.sort(function(e,t){return e.rank-t.rank}),s(t,o)):($(".topicResults").remove(),h.show())}function s(e,o){$(".topicResults").remove(),$(".showList").show(),h.hide();var n=$("<div/>",{"class":"topicResults",html:"<h2>"+f.results+"</h2>"}).appendTo(".topicSearchWrapper"),a=[],r=Object.keys(e).length;r>0?($.each(e,function(e,o){var r=h.find("a[data-topicid='"+o.topicid+"']"),s=r.attr("data-alternative-spellings").split(", "),p=[];for(i=p.length;i<5;){if("undefined"!=typeof s[i]){var c=s[i].trim().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g,"");""!==c&&p.indexOf(c)===-1&&p.push(c)}i++}var l="";if(p.length>0){var u="";for(t=0;t<3;t++)"undefined"!=typeof p[t]&&(u+=p[t]),t<2&&"undefined"!=typeof p[t+1]&&(u+=", ");l="<p>"+f.foundOn+": "+u+"</p>"}if(a.indexOf(r.html())===-1){a.push(r.html());var d=$("<div/>",{"class":"foundTopic"}).appendTo(n),v=$("<a/>",{href:r.attr("href"),"data-keyword":r.html(),html:"<h3>"+r.html()+"</h3>"+l}).appendTo(d);v.on("click",function(){_paq.push(["trackEvent","Onderwerp overzicht","Gevonden onderwerp openen",$(this).data("keyword")])})}}),_paq.push(["trackEvent","Onderwerp overzicht","Onderwerp zoeken",o,a.length])):(_paq.push(["trackEvent","Onderwerp overzicht","Onderwerp zoeken",o,"0"]),$("<p/>",{html:f.noresults}).appendTo(n))}function p(){$("a[href='#topic-home']").click(function(e){e.preventDefault(),e.stopPropagation();var t=$(this.hash),o="a[name="+this.hash.slice(1)+"]";t=t.length&&t||$(o);var n=t.offset().top;$("html, body").stop().animate({scrollTop:n},500)})}var c=$(this),l=$("#topicQ"),h=$(".topicsOverview"),u=h.find("li a"),d=($(".topicsList"),[]),f={results:c.attr("data-results")||"Gevonden onderwerpen",noresults:c.attr("data-noresults")||"Geen onderwerpen gevonden",foundOn:c.attr("data-found-on-keyword")||"Gaat over"};e()})},$("#topicSearch").topicSearch();