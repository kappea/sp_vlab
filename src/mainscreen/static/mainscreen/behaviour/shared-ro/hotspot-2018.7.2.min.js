$.fn.createHotspot=function(){var e={position:"center",displayType:"desktop",minToolTipSpace:20},t=$.extend({},e);return this.each(function(){function r(){e.settings=t,e.imageMap=e.find(".hotspotmap"),e.spotData=e.find(".hotspotinfo"),e.hotspots=e.imageMap.find("li"),e.anchors=e.imageMap.find("a"),i(),u(),s(),o()}function i(){e.spotData.find("div").each(function(t,n){var r=$(this).find(".thumb").clone();r.length>0&&e.imageMap.find('li[data-id="'+$(this).attr("id")+'"] a').append(r).addClass("hasThumb")})}function s(){e.each(function(){var t=$(this).find(".hotspotimage"),n=$(this).find("p").first().hasClass("copyright"),r=$(this).find("p").first().hasClass("cite");if(r){var i=$(this).find("p.cite");i.insertAfter(t)}else if(n){var s=$(this).find("p.copyright");s.insertAfter(t)}})}function o(){e.anchors.on("click",function(t){t.preventDefault();var n=$(this).parent("li"),r=n.attr("data-id");Core.viewport==="mobile"||Core.viewport==="phablet"||Core.viewport==="tablet"?$("html, body").animate({scrollTop:$("#"+r).offset().top-30},"slow"):$(this).hasClass("open")?($(this).removeClass("open"),n.find(".tooltip").hide()):(f(),e.anchors.removeClass("open"),$(this).addClass("open"),n.find(".tooltip").length===0?a(r):n.find(".tooltip").show())}),$(window).on("resize orientationchange",function(){l(),u()}),e.find(".scrollToTop").click(function(){$("html, body").animate({scrollTop:0},"slow")})}function u(){e.spotData.find("img").not(".thumb").each(function(){$img=$(this),$imgClass=$(this).attr("class"),Core.viewport==="mobile"||Core.viewport==="phablet"||Core.viewport==="tablet"||$imgClass==="bottom"?$img.appendTo($img.parent("div")):$img.prependTo($img.parent("div"))})}function a(t){var n=e.imageMap.find('li[data-id="'+t+'"]'),r=n.find("a"),i=e.spotData.find("#"+t),s=r.outerWidth(),o=r.outerHeight(),u=$("<div/>",{"class":"tooltip",tabindex:"0",html:i.html()}).appendTo(n);u.find("img").each(function(){var e=$(this).attr("class");e!=="thumb"&&(u.addClass("image"+e),e!=="bottom"&&($img=$(this),$(this).remove(),$img.prependTo(u).addClass("moved")))});var a=u.innerWidth();u.css({left:-a/2,bottom:o/2+15}),u.offset().left-e.offset().left<e.settings.minToolTipSpace&&(u.addClass("left"),u.css({left:-20}));var f=e.innerWidth()-(u.offset().left-e.offset().left+u.innerWidth());if(f<e.settings.minToolTipSpace)if(u.hasClass("left")){var l=u.outerWidth()-(f+u.outerWidth()-e.settings.minToolTipSpace);u.outerWidth(u.outerWidth()-l)}else{u.addClass("right"),u.css({left:-a+20});var c=u.offset().left-e.offset().left-e.settings.minToolTipSpace;c<0&&(u.outerWidth(u.outerWidth()+c),u.css({left:+u.position().left-c}))}u.offset().top-e.offset().top<e.settings.minToolTipSpace&&(u.addClass("bottom"),u.css({bottom:"auto",top:o/2+15}))}function f(){e.imageMap.find(".open").removeClass("open").parent("li").find(".tooltip").hide()}function l(){f(),e.imageMap.find(".tooltip").remove()}var e=$(this),n=$(window).width();r()})},$(".hotspotContainer").createHotspot()
