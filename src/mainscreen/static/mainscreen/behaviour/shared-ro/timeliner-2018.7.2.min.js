$.fn.timeline=function(){return this.each(function(){function r(){s(),i()}function i(){Core.sizer("small")?e.find(".loadLazy").hide():e.find(".loadLazy").lazyload({skip_invisible:!1})}function s(){$(".timelineMajor").each(function(e,t){$(this).hasClass("open")&&$(this).find(".majorEvent").attr({"aria-hidden":!1,"aria-expanded":!0})}),$(".timelineMinor").each(function(){$(this).hasClass("open")&&$(this).find(".timelineEvent").attr({"aria-hidden":!1,"aria-expanded":!0})}),$(".timelineEvent > table").wrap('<div class="scrollcontainer" />'),o()}function o(){$(".timelineToggle").hasClass("open")?$(".timelineToggle").find("a").html(n):$(".timelineToggle").find("a").html(t),e.find(".timelineToggle a").on("click",function(r){r.preventDefault();var i=e.find(".timelineToggle"),s=e.find(".timelineMajor"),o=$("html,body"),f=$(this).parent().parent(".timeline");navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/)?window.scrollTo(0,f.offset().top-o.offset().top):o.animate({scrollTop:f.offset().top-o.offset().top,scrollLeft:0},300),i.hasClass("open")?(s.each(function(){a($(this))}),i.find("a").html(t),i.removeClass("open")):(s.each(function(){u($(this),!1)}),i.find("a").html(n),i.addClass("open"))}),e.find(".timelineMajorMarker a").on("click",function(e){e.preventDefault();var t=$(this).parents(".timelineMajor");t.hasClass("open")?a(t):u(t,!0)}),e.find(".timelineEventHead a").on("click",function(e){e.preventDefault();var t=$(this).parents(".timelineMinor");t.hasClass("open")?l(t):f(t)})}function u(e,t){$minors=e.find(".timelineMinor"),e.addClass("open");var n=e.find(".majorEvent");n.attr({"aria-hidden":!1,"aria-expanded":!0}),t&&n.focus()}function a(e){$minors=e.find(".timelineMinor"),$minors.each(function(){l($(this))});var t=e.find(".majorEvent");t.attr({"aria-hidden":!0,"aria-expanded":!1}),e.removeClass("open")}function f(e){e.addClass("open");var t=e.find(".timelineEvent");t.attr({"aria-hidden":!1,"aria-expanded":!0}),t.focus()}function l(e){e.removeClass("open"),e.find(".timelineEvent").attr({"aria-hidden":!0,"aria-expanded":!1}),$("video,audio").trigger("pause")}var e=$(this),t=$(this).data("expand"),n=$(this).data("collapse");r()})},$(".timeline").timeline()
