$.fn.createHotspot=function(){var t={position:"center",displayType:"desktop",minToolTipSpace:20},i=$.extend({},t);return this.each(function(){function t(){d.settings=i,d.imageMap=d.find(".hotspotmap"),d.spotData=d.find(".hotspotinfo"),d.hotspots=d.imageMap.find("li"),d.anchors=d.imageMap.find("a"),o(),a(),e(),s()}function o(){d.spotData.find("div").each(function(t,i){var o=$(this).find(".thumb").clone();o.length>0&&d.imageMap.find('li[data-id="'+$(this).attr("id")+'"] a').append(o).addClass("hasThumb")})}function e(){d.each(function(){var t=$(this).find(".hotspotimage"),i=$(this).find("p").first().hasClass("copyright"),o=$(this).find("p").first().hasClass("cite");if(o){var e=$(this).find("p.cite");e.insertAfter(t)}else if(i){var s=$(this).find("p.copyright");s.insertAfter(t)}})}function s(){d.anchors.on("click",function(t){t.preventDefault();var i=$(this).parent("li"),o=i.attr("data-id");"mobile"===Core.viewport||"phablet"===Core.viewport||"tablet"===Core.viewport?$("html, body").animate({scrollTop:$("#"+o).offset().top-30},"slow"):$(this).hasClass("open")?($(this).removeClass("open"),i.find(".tooltip").hide()):(p(),d.anchors.removeClass("open"),$(this).addClass("open"),0===i.find(".tooltip").length?n(o):i.find(".tooltip").show())}),$(window).on("resize orientationchange",function(){f(),a()}),d.find(".scrollToTop").click(function(){$("html, body").animate({scrollTop:0},"slow")})}function a(){d.spotData.find("img").not(".thumb").each(function(){$img=$(this),$imgClass=$(this).attr("class"),"mobile"===Core.viewport||"phablet"===Core.viewport||"tablet"===Core.viewport||"bottom"===$imgClass?$img.appendTo($img.parent("div")):$img.prependTo($img.parent("div"))})}function n(t){var i=d.imageMap.find('li[data-id="'+t+'"]'),o=i.find("a"),e=d.spotData.find("#"+t),s=(o.outerWidth(),o.outerHeight()),a=$("<div/>",{"class":"tooltip",tabindex:"0",html:e.html()}).appendTo(i);a.find("img").each(function(){var t=$(this).attr("class");"thumb"!==t&&(a.addClass("image"+t),"bottom"!==t&&($img=$(this),$(this).remove(),$img.prependTo(a).addClass("moved")))});var n=a.innerWidth();a.css({left:-n/2,bottom:s/2+15}),a.offset().left-d.offset().left<d.settings.minToolTipSpace&&(a.addClass("left"),a.css({left:-20}));var p=d.innerWidth()-(a.offset().left-d.offset().left+a.innerWidth());if(p<d.settings.minToolTipSpace)if(a.hasClass("left")){var f=a.outerWidth()-(p+a.outerWidth()-d.settings.minToolTipSpace);a.outerWidth(a.outerWidth()-f)}else{a.addClass("right"),a.css({left:-n+20});var l=a.offset().left-d.offset().left-d.settings.minToolTipSpace;l<0&&(a.outerWidth(a.outerWidth()+l),a.css({left:+a.position().left-l}))}a.offset().top-d.offset().top<d.settings.minToolTipSpace&&(a.addClass("bottom"),a.css({bottom:"auto",top:s/2+15}))}function p(){d.imageMap.find(".open").removeClass("open").parent("li").find(".tooltip").hide()}function f(){p(),d.imageMap.find(".tooltip").remove()}var d=$(this);$(window).width(),t()})},$(".hotspotContainer").createHotspot();